<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Fill in a module description here">

<title>singleline_dataset - clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="singleline_dataset - clustering">
<meta property="og:description" content="Fill in a module description here">
<meta property="og:site_name" content="singleline_dataset">
<meta name="twitter:title" content="singleline_dataset - clustering">
<meta name="twitter:description" content="Fill in a module description here">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">singleline_dataset</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./e2e_subclusters.html">clustering</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">singleline_dataset</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fileorg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fileorg</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">embeddings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./svg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">svg_files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">display</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">transforms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strokes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">path_joining</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dataset</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bounding_boxes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">bounding_boxes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stroke3_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./e2e_subclusters.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">clustering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./embed_sep_bboxes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">vectorize</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./viz_subclusters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">e2e</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./emb_projector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">e2e</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectorize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">vectorize</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BLIP captioning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tokenize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tokenize</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformer_results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tokenize</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_augmentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data_augmentation</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#separate-dfs-for-drawings-watercolors" id="toc-separate-dfs-for-drawings-watercolors" class="nav-link active" data-scroll-target="#separate-dfs-for-drawings-watercolors">separate DF’s for drawings, watercolors</a>
  <ul class="collapse">
  <li><a href="#drawings_emb" id="toc-drawings_emb" class="nav-link" data-scroll-target="#drawings_emb">drawings_emb</a></li>
  <li><a href="#drawings_emb_cropped" id="toc-drawings_emb_cropped" class="nav-link" data-scroll-target="#drawings_emb_cropped">drawings_emb_cropped</a></li>
  <li><a href="#watercolors_emb" id="toc-watercolors_emb" class="nav-link" data-scroll-target="#watercolors_emb">watercolors_emb</a></li>
  <li><a href="#watercolors_emb_cropped" id="toc-watercolors_emb_cropped" class="nav-link" data-scroll-target="#watercolors_emb_cropped">watercolors_emb_cropped</a></li>
  </ul></li>
  <li><a href="#side-quest-varying-the-numbers-of-centroids-for-drawings" id="toc-side-quest-varying-the-numbers-of-centroids-for-drawings" class="nav-link" data-scroll-target="#side-quest-varying-the-numbers-of-centroids-for-drawings">side quest: varying the numbers of centroids for drawings</a>
  <ul class="collapse">
  <li><a href="#drawings_cropped-variations" id="toc-drawings_cropped-variations" class="nav-link" data-scroll-target="#drawings_cropped-variations">drawings_cropped variations</a></li>
  </ul></li>
  <li><a href="#saving-cluster-outputs" id="toc-saving-cluster-outputs" class="nav-link" data-scroll-target="#saving-cluster-outputs">saving cluster outputs</a>
  <ul class="collapse">
  <li><a href="#save-the-tsvs-with-cluster-ids" id="toc-save-the-tsvs-with-cluster-ids" class="nav-link" data-scroll-target="#save-the-tsvs-with-cluster-ids">save the TSV’s with cluster ID’s</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/andrewlook/singleline_dataset/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">clustering</h1>
</div>

<div>
  <div class="description">
    Fill in a module description here
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> singleline_dataset.embeddings <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> singleline_dataset.fileorg <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>no env var SINGLELINE_DATA_HOME, defaulting to: None</code></pre>
</div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>EXTERNAL_PARENT_DIR <span class="op">=</span> Path(<span class="st">'/Users/al/Dropbox/2-Areas/2-Sketchbooks'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>EXTERNAL_SKETCHBOOKS_DIR <span class="op">=</span> EXTERNAL_PARENT_DIR <span class="op">/</span> <span class="st">'sketchbooks'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>EXTERNAL_DATA_HOME <span class="op">=</span> EXTERNAL_PARENT_DIR <span class="op">/</span> <span class="st">'singleline_data'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>EPOCH <span class="op">=</span> SketchbookEpoch(epoch<span class="op">=</span><span class="st">'20231214'</span>, data_home<span class="op">=</span>EXTERNAL_DATA_HOME)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>CURR_01_FLAT <span class="op">=</span> EPOCH.dir_01_FLAT()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>CURR_02_CATEGORIZED <span class="op">=</span> EPOCH.dir_02_CATEGORIZED()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>CURR_03_HAND <span class="op">=</span> EPOCH.dir_03_HANDLABELED()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>no env var SINGLELINE_DATA_HOME, defaulting to: None</code></pre>
</div>
</div>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>EXTERNAL_SKETCHBOOKS_DIR.ls()[:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(#2) [Path('/Users/al/Dropbox/2-Areas/2-Sketchbooks/sketchbooks/sb67'),Path('/Users/al/Dropbox/2-Areas/2-Sketchbooks/sketchbooks/sb69')]</code></pre>
</div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flatten_sketchbooks(EXTERNAL_SKETCHBOOKS_DIR, CURR_01_FLAT)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>CURR_01_FLAT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('/Users/al/Dropbox/2-Areas/2-Sketchbooks/singleline_data/raster/epoch-20231214/01_FLAT')</code></pre>
</div>
</div>
<section id="separate-dfs-for-drawings-watercolors" class="level2">
<h2 class="anchored" data-anchor-id="separate-dfs-for-drawings-watercolors">separate DF’s for drawings, watercolors</h2>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>drawings_df <span class="op">=</span> cdf[cdf.handlabeled_metacluster_name <span class="op">==</span> <span class="st">"0_drawings"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>sb77p043.jpg</td>
<td>1_watercolors/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>sb77p043.jpg</td>
<td>1_watercolors/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reindex so I have you</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>drawings_df.set_index(pd.Index(<span class="bu">range</span>(<span class="bu">len</span>(drawings_df))), inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>drawings_df.label.hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>drawings_df.cluster.hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>watercolors_df <span class="op">=</span> cdf[cdf.handlabeled_metacluster_name <span class="op">==</span> <span class="st">"1_watercolors"</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>watercolors_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>watercolors_df.set_index(pd.Index(<span class="bu">range</span>(<span class="bu">len</span>(watercolors_df))), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>watercolors_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>watercolors_df.label.hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>watercolors_df.cluster.hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>drawings_tsv_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>preprocessing_dir<span class="sc">}</span><span class="ss">/drawings.tsv"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>drawings_df.to_csv(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    drawings_tsv_fname, index<span class="op">=</span><span class="va">True</span>, index_label<span class="op">=</span><span class="st">"idx"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, header<span class="op">=</span><span class="va">True</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>drawing_df <span class="op">=</span> pd.read_csv(drawings_tsv_fname, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, index_col<span class="op">=</span><span class="st">"idx"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>drawing_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>sb77p043.jpg</td>
<td>1_watercolors/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-23" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>watercolors_tsv_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>preprocessing_dir<span class="sc">}</span><span class="ss">/watercolors.tsv"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>watercolors_df.to_csv(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    watercolors_tsv_fname, index<span class="op">=</span><span class="va">True</span>, index_label<span class="op">=</span><span class="st">"idx"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, header<span class="op">=</span><span class="va">True</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>watercolor_df <span class="op">=</span> pd.read_csv(watercolors_tsv_fname, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, index_col<span class="op">=</span><span class="st">"idx"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>watercolor_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">indiv_fname</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>drawings_emb <span class="op">=</span> np.stack(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    [np.array([<span class="bu">float</span>(f) <span class="cf">for</span> f <span class="kw">in</span> s.split(<span class="st">","</span>)]) <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">list</span>(drawings_df.emb_csv)]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>).astype(np.float32)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>drawings_cropped_emb <span class="op">=</span> np.stack(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        np.array([<span class="bu">float</span>(f) <span class="cf">for</span> f <span class="kw">in</span> s.split(<span class="st">","</span>)])</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">list</span>(drawings_df.emb_csv_cropped)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>).astype(np.float32)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>drawings_emb.shape, drawings_cropped_emb.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((1923, 512), (1923, 512))</code></pre>
</div>
</div>
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>watercolors_emb <span class="op">=</span> np.stack(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    [np.array([<span class="bu">float</span>(f) <span class="cf">for</span> f <span class="kw">in</span> s.split(<span class="st">","</span>)]) <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">list</span>(watercolors_df.emb_csv)]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>).astype(np.float32)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_emb <span class="op">=</span> np.stack(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        np.array([<span class="bu">float</span>(f) <span class="cf">for</span> f <span class="kw">in</span> s.split(<span class="st">","</span>)])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">list</span>(watercolors_df.emb_csv_cropped)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>).astype(np.float32)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>watercolors_emb.shape, watercolors_cropped_emb.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((404, 512), (404, 512))</code></pre>
</div>
</div>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>drawings_X_tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit_transform(drawings_emb)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>], y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>], c<span class="op">=</span>drawings_df.cluster, s<span class="op">=</span><span class="fl">2.0</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-27" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>drawings_cropped_X_tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit_transform(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.cluster,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>drawings_index <span class="op">=</span> faiss.IndexFlatL2(emb_dim)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>drawings_index.add(drawings_emb)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_index <span class="op">=</span> faiss.IndexFlatL2(emb_dim)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>drawings_cropped_index.add(drawings_cropped_emb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>watercolors_X_tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit_transform(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    watercolors_emb</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>watercolors_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>watercolors_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>watercolors_df.cluster,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">5.0</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_X_tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit_transform(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    watercolors_cropped_emb</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>watercolors_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>watercolors_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>watercolors_df.cluster,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">5.0</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-32" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>watercolors_index <span class="op">=</span> faiss.IndexFlatL2(emb_dim)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>watercolors_index.add(watercolors_emb)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_index <span class="op">=</span> faiss.IndexFlatL2(emb_dim)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_index.add(watercolors_cropped_emb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="drawings_emb" class="level3">
<h3 class="anchored" data-anchor-id="drawings_emb">drawings_emb</h3>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>1_watercolors/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-36" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>drawings_df <span class="op">=</span> drawings_df.reindex()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-37" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">visual_rel_path</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>1_watercolors/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>drawings_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    drawings_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>drawings_kmeans.train(drawings_emb)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>drawings_D, drawings_I <span class="op">=</span> drawings_index.search(drawings_kmeans.centroids, <span class="dv">16</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>drawings_kD, drawings_kI <span class="op">=</span> drawings_kmeans.index.search(drawings_emb, <span class="dv">1</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster_id"</span>] <span class="op">=</span> drawings_kI</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster_dist"</span>] <span class="op">=</span> drawings_kD</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb77p043.jpg</td>
<td>0_drawings/sb77p043.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
<td>217.249588</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb67p021.jpg</td>
<td>0_drawings/sb67p021.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
<td>169.947693</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb25p227.jpg</td>
<td>0_drawings/sb25p227.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
<td>162.882431</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb48p057.jpg</td>
<td>0_drawings/sb48p057.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
<td>94.257965</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/0_drawings/sb77p044.jpg</td>
<td>0_drawings/sb77p044.jpg</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
<td>173.559937</td>
</tr>
</tbody>
</table>

<p>5 rows × 23 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-39" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(clusters_df<span class="op">=</span>drawings_df, clusters<span class="op">=</span>drawings_I, title<span class="op">=</span><span class="st">"drawings_emb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cluster_id,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-38-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_emb_cropped" class="level3">
<h3 class="anchored" data-anchor-id="drawings_emb_cropped">drawings_emb_cropped</h3>
<div id="cell-42" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>drawings_cropped_kmeans.train(drawings_cropped_emb)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>drawings_cropped_D, drawings_cropped_I <span class="op">=</span> drawings_cropped_index.search(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>drawings_cropped_kD, drawings_cropped_kI <span class="op">=</span> drawings_cropped_kmeans.index.search(</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb, <span class="dv">1</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster_id"</span>] <span class="op">=</span> drawings_cropped_kI</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster_dist"</span>] <span class="op">=</span> drawings_cropped_kD</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>0_drawings</td>
<td>0</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
<td>217.249588</td>
<td>5</td>
<td>332.983734</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
<td>169.947693</td>
<td>5</td>
<td>126.699768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
<td>162.882431</td>
<td>5</td>
<td>257.762512</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
<td>94.257965</td>
<td>2</td>
<td>145.937225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>0_drawings</td>
<td>0</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
<td>173.559937</td>
<td>5</td>
<td>197.142792</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>drawings_df, clusters<span class="op">=</span>drawings_cropped_I, title<span class="op">=</span><span class="st">"drawings_cropped_emb"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cropped_cluster_id,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="watercolors_emb" class="level3">
<h3 class="anchored" data-anchor-id="watercolors_emb">watercolors_emb</h3>
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>watercolors_df <span class="op">=</span> watercolors_df.reindex()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-48" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>watercolors_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    watercolors_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>watercolors_kmeans.train(watercolors_emb)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>watercolors_D, watercolors_I <span class="op">=</span> watercolors_index.search(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    watercolors_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>watercolors_kD, watercolors_kI <span class="op">=</span> watercolors_kmeans.index.search(watercolors_emb, <span class="dv">1</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>watercolors_df.loc[:, <span class="st">"watercolors_cluster_id"</span>] <span class="op">=</span> watercolors_kI</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>watercolors_df.loc[:, <span class="st">"watercolors_cluster_dist"</span>] <span class="op">=</span> watercolors_kD</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>watercolors_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">visual_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_rel_path</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_id</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb07p104.jpg</td>
<td>1_watercolors/sb07p104.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
<td>7</td>
<td>215.029266</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb31p017.jpg</td>
<td>1_watercolors/sb31p017.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
<td>4</td>
<td>199.030975</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb05p079.jpg</td>
<td>1_watercolors/sb05p079.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
<td>4</td>
<td>142.766022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb26p082.jpg</td>
<td>1_watercolors/sb26p082.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
<td>1</td>
<td>157.938324</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/02_VISUAL_CATEGORIES/1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors/sb69p101-color.jpg</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
<td>1</td>
<td>167.278229</td>
</tr>
</tbody>
</table>

<p>5 rows × 23 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>watercolors_df, clusters<span class="op">=</span>watercolors_I, title<span class="op">=</span><span class="st">"watercolors_emb"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>watercolors_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>watercolors_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>watercolors_df.watercolors_cluster_id,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">8.0</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="watercolors_emb_cropped" class="level3">
<h3 class="anchored" data-anchor-id="watercolors_emb_cropped">watercolors_emb_cropped</h3>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    watercolors_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_kmeans.train(watercolors_cropped_emb)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>watercolors_cropped_D, watercolors_cropped_I <span class="op">=</span> watercolors_cropped_index.search(</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    watercolors_cropped_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    watercolors_cropped_kD,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    watercolors_cropped_kI,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> watercolors_cropped_kmeans.index.search(watercolors_cropped_emb, <span class="dv">1</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>watercolors_df.loc[:, <span class="st">"watercolors_cropped_cluster_id"</span>] <span class="op">=</span> watercolors_cropped_kI</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>watercolors_df.loc[:, <span class="st">"watercolors_cropped_cluster_dist"</span>] <span class="op">=</span> watercolors_cropped_kD</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>watercolors_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_id</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_dist</th>
<th data-quarto-table-cell-role="th">watercolors_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">watercolors_cropped_cluster_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
<td>7</td>
<td>215.029266</td>
<td>7</td>
<td>206.641174</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
<td>4</td>
<td>199.030975</td>
<td>4</td>
<td>195.975464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
<td>4</td>
<td>142.766022</td>
<td>4</td>
<td>248.372314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
<td>1</td>
<td>157.938324</td>
<td>1</td>
<td>196.849426</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
<td>1</td>
<td>167.278229</td>
<td>1</td>
<td>136.638000</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-54" class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>watercolors_df,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    clusters<span class="op">=</span>watercolors_cropped_I,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"watercolors_cropped_emb"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>watercolors_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>watercolors_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>watercolors_df.watercolors_cropped_cluster_id,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">8.0</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="side-quest-varying-the-numbers-of-centroids-for-drawings" class="level2">
<h2 class="anchored" data-anchor-id="side-quest-varying-the-numbers-of-centroids-for-drawings">side quest: varying the numbers of centroids for drawings</h2>
<section id="drawings_cluster16" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cluster16">drawings_cluster16</h4>
<div id="cell-58" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>drawings_cluster16_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    drawings_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>drawings_cluster16_kmeans.train(drawings_emb)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>drawings_cluster16_D, drawings_cluster16_I <span class="op">=</span> drawings_index.search(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    drawings_cluster16_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>drawings_cluster16_kD, drawings_cluster16_kI <span class="op">=</span> drawings_cluster16_kmeans.index.search(</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    drawings_emb, <span class="dv">1</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster16_id"</span>] <span class="op">=</span> drawings_cluster16_kI</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster16_dist"</span>] <span class="op">=</span> drawings_cluster16_kD</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
<td>217.249588</td>
<td>5</td>
<td>332.983734</td>
<td>15</td>
<td>166.716202</td>
<td>3</td>
<td>169.585052</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
<td>169.947693</td>
<td>5</td>
<td>126.699768</td>
<td>18</td>
<td>137.920044</td>
<td>8</td>
<td>141.980621</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
<td>162.882431</td>
<td>5</td>
<td>257.762512</td>
<td>8</td>
<td>154.434723</td>
<td>14</td>
<td>161.993011</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
<td>94.257965</td>
<td>2</td>
<td>145.937225</td>
<td>28</td>
<td>85.081177</td>
<td>15</td>
<td>92.158417</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
<td>173.559937</td>
<td>5</td>
<td>197.142792</td>
<td>25</td>
<td>167.685181</td>
<td>0</td>
<td>166.856781</td>
</tr>
</tbody>
</table>

<p>5 rows × 29 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>drawings_df,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    clusters<span class="op">=</span>drawings_cluster16_I,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"drawings_cluster16_emb"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-60" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cluster16_id,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-53-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cluster32" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cluster32">drawings_cluster32</h4>
<div id="cell-62" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>drawings_cluster32_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    drawings_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>drawings_cluster32_kmeans.train(drawings_emb)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>drawings_cluster32_D, drawings_cluster32_I <span class="op">=</span> drawings_index.search(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    drawings_cluster32_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>drawings_cluster32_kD, drawings_cluster32_kI <span class="op">=</span> drawings_cluster32_kmeans.index.search(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    drawings_emb, <span class="dv">1</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster32_id"</span>] <span class="op">=</span> drawings_cluster32_kI</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster32_dist"</span>] <span class="op">=</span> drawings_cluster32_kD</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>False</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p043.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p043.jpg</td>
<td>-0.6198182,-0.5714155,0.2937309,0.2691822,-0.6254566,-0.46855158,-0.7267234,-0.4896673,-0.7537334,-0.42715576,2.241211,-0.013144195,-0.30681813,-0.6266761,0.43516117,-0.57515705,-0.5467274,-0.5245168,1.3334948,2.1400952,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.38178188,-0.5982413,-0.50063276,-0.21540937,0.4948988,-0.67007643,-0.52171326,-0.4592305,1.8570362,-0.6186755,0.94023055,-0.57338566,0.5270257,-0.6179389,2.302543,1.1004333,0.15528035,-0.6682474,1.890626,-0.59257406,1.331521,-0.6001429,1.5220151,0.93749076,-0.59497476,-0.66552746,-0.6482407,-0.4732165,0....</td>
<td>3</td>
<td>217.249588</td>
<td>5</td>
<td>332.983734</td>
<td>15</td>
<td>166.716202</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb67p021.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb67p021.jpg</td>
<td>-0.20756221,-0.24843562,0.29454154,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.9697293,-0.72562873,-0.662768,-0.6266761,-0.23836556,0.4814458,-0.5467274,-0.6520286,0.838902,-0.6497359,-0.57338166,-0.55193967,-0.5446661,-0.28419846,1.6012006,-0.6690378,-0.4518578,-0.0104218125,-0.73986673,-0.3002332,-0.68509877,-0.67007643,-0.36297536,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,-0.65925777,1.6904012,-0.61049384,-0.58021957,0.508085,0.14767355,0.8082305,-0.59257406,-0.6157326,-0.6001429,-0.651804,-0.30467254,0.17396247,-0.66552746,-0.6482407,-0.0...</td>
<td>2</td>
<td>169.947693</td>
<td>5</td>
<td>126.699768</td>
<td>18</td>
<td>137.920044</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb25p227.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb25p227.jpg</td>
<td>-0.6198182,-0.428226,-0.73929733,-0.6553513,-0.49369657,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.28293163,-0.62038505,-0.32824886,2.5504894,-0.6266761,0.8397537,0.85716057,-0.5467274,-0.058725297,0.64954805,-0.6497359,-0.64108604,-0.36876833,-0.5446661,-0.29563427,0.08626467,-0.6690378,-0.4518578,0.64337015,-0.73986673,0.018805295,-0.68509877,-0.67007643,1.5876667,-0.4592305,-0.600525,-0.6186755,0.28688914,-0.57338566,-0.65925777,1.6810645,-0.61049384,1.8564332,-0.6189488,-0.6682474,-0.75794554,-0.59257406,-0.6157326,-0.6001429,-0.63579994,-0.45296612,-0.29925343,-0.0263654,-0.64824...</td>
<td>3</td>
<td>162.882431</td>
<td>5</td>
<td>257.762512</td>
<td>8</td>
<td>154.434723</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb48p057.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb48p057.jpg</td>
<td>-0.34353483,-0.5714155,2.2665114,-0.6553513,-0.42076486,-0.6254998,-0.7267234,-0.4896673,-0.7537334,-0.42715576,0.6137707,-0.72562873,0.2611376,1.0485492,0.91806084,-0.452704,-0.5467274,-0.6520286,0.621349,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.7967064,0.011958599,-0.4518578,-0.25104153,-0.6493137,-0.45211998,-0.02894944,-0.67007643,1.3037661,-0.4592305,-0.600525,-0.6186755,-0.072172046,-0.57338566,0.42140257,0.8994249,-0.61049384,-0.35844505,-0.03452295,-0.40064916,0.1334514,-0.59257406,-0.06328797,-0.6001429,-0.651804,-0.5315948,0.55393887,-0.66552746,-0.6482407,0.165...</td>
<td>4</td>
<td>94.257965</td>
<td>2</td>
<td>145.937225</td>
<td>28</td>
<td>85.081177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/0_drawings/sb77p044.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/0_drawings/sb77p044.jpg</td>
<td>-0.3477007,-0.5714155,-0.73929733,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14662892,-0.43905735,-0.64813715,0.059202433,-0.6266761,-0.51404697,-0.20505324,-0.5467274,-0.6520286,1.2549256,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.41643643,-0.6690378,-0.22824319,-0.5982413,-0.73986673,-0.3338361,-0.68509877,0.10866904,-0.1451351,-0.4592305,0.5446466,0.7924262,-0.73933,-0.57338566,-0.45801556,-0.11409092,-0.4252534,0.4120332,-0.6189488,-0.28175777,2.210379,-0.59257406,-0.070759535,-0.6001429,-0.651804,0.012511611,0.26820052,-0.66552746,0.9221995,...</td>
<td>0</td>
<td>173.559937</td>
<td>5</td>
<td>197.142792</td>
<td>25</td>
<td>167.685181</td>
</tr>
</tbody>
</table>

<p>5 rows × 27 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>drawings_df,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    clusters<span class="op">=</span>drawings_cluster32_I,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"drawings_cluster32_emb"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-64" class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cluster32_id,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="drawings_cluster48" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cluster48">drawings_cluster48</h4>
<div id="cell-66" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">48</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>drawings_cluster48_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    drawings_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>drawings_cluster48_kmeans.train(drawings_emb)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>drawings_cluster48_D, drawings_cluster48_I <span class="op">=</span> drawings_index.search(</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    drawings_cluster48_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>drawings_cluster48_kD, drawings_cluster48_kI <span class="op">=</span> drawings_cluster48_kmeans.index.search(</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    drawings_emb, <span class="dv">1</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster48_id"</span>] <span class="op">=</span> drawings_cluster48_kI</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster48_dist"</span>] <span class="op">=</span> drawings_cluster48_kD</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>5</td>
<td>332.983734</td>
<td>15</td>
<td>166.716202</td>
<td>3</td>
<td>169.585052</td>
<td>58</td>
<td>145.230499</td>
<td>15</td>
<td>166.337051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>5</td>
<td>126.699768</td>
<td>18</td>
<td>137.920044</td>
<td>8</td>
<td>141.980621</td>
<td>45</td>
<td>136.906982</td>
<td>45</td>
<td>137.201172</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>5</td>
<td>257.762512</td>
<td>8</td>
<td>154.434723</td>
<td>14</td>
<td>161.993011</td>
<td>61</td>
<td>150.458466</td>
<td>8</td>
<td>148.634705</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>2</td>
<td>145.937225</td>
<td>28</td>
<td>85.081177</td>
<td>15</td>
<td>92.158417</td>
<td>28</td>
<td>87.053833</td>
<td>28</td>
<td>83.963623</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>5</td>
<td>197.142792</td>
<td>25</td>
<td>167.685181</td>
<td>0</td>
<td>166.856781</td>
<td>21</td>
<td>162.981720</td>
<td>39</td>
<td>169.478943</td>
</tr>
</tbody>
</table>

<p>5 rows × 33 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>show_all_clusters(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    clusters_df<span class="op">=</span>drawings_df,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    clusters<span class="op">=</span>drawings_cluster48_I,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"drawings_cluster48_emb"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cluster48_id,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-59-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cluster64" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cluster64">drawings_cluster64</h4>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>drawings_cluster64_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    drawings_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>drawings_cluster64_kmeans.train(drawings_emb)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>drawings_cluster64_D, drawings_cluster64_I <span class="op">=</span> drawings_index.search(</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    drawings_cluster64_kmeans.centroids, <span class="dv">16</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>drawings_cluster64_kD, drawings_cluster64_kI <span class="op">=</span> drawings_cluster64_kmeans.index.search(</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    drawings_emb, <span class="dv">1</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster64_id"</span>] <span class="op">=</span> drawings_cluster64_kI</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cluster64_dist"</span>] <span class="op">=</span> drawings_cluster64_kD</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING clustering 1923 points to 64 centroids: please provide at least 2496 training points</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>3</td>
<td>217.249588</td>
<td>5</td>
<td>332.983734</td>
<td>15</td>
<td>166.716202</td>
<td>3</td>
<td>169.585052</td>
<td>58</td>
<td>145.230499</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>2</td>
<td>169.947693</td>
<td>5</td>
<td>126.699768</td>
<td>18</td>
<td>137.920044</td>
<td>8</td>
<td>141.980621</td>
<td>45</td>
<td>136.906982</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>3</td>
<td>162.882431</td>
<td>5</td>
<td>257.762512</td>
<td>8</td>
<td>154.434723</td>
<td>14</td>
<td>161.993011</td>
<td>61</td>
<td>150.458466</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>4</td>
<td>94.257965</td>
<td>2</td>
<td>145.937225</td>
<td>28</td>
<td>85.081177</td>
<td>15</td>
<td>92.158417</td>
<td>28</td>
<td>87.053833</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>173.559937</td>
<td>5</td>
<td>197.142792</td>
<td>25</td>
<td>167.685181</td>
<td>0</td>
<td>166.856781</td>
<td>21</td>
<td>162.981720</td>
</tr>
</tbody>
</table>

<p>5 rows × 31 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-71" class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show_all_clusters(</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters_df=drawings_df,</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters=drawings_cluster64_I,</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title="drawings_cluster64_emb",</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cluster64_id,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-62-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cropped-variations" class="level3">
<h3 class="anchored" data-anchor-id="drawings_cropped-variations">drawings_cropped variations</h3>
<section id="drawings_cropped_cluster16" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cropped_cluster16">drawings_cropped_cluster16</h4>
<div id="cell-75" class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster16_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster16_kmeans.train(drawings_cropped_emb)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster16_D,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster16_I,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_index.search(drawings_cropped_cluster16_kmeans.centroids, <span class="dv">16</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster16_kD,</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster16_kI,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_cluster16_kmeans.index.search(drawings_cropped_emb, <span class="dv">1</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster16_id"</span>] <span class="op">=</span> drawings_cropped_cluster16_kI</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster16_dist"</span>] <span class="op">=</span> drawings_cropped_cluster16_kD</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>15</td>
<td>166.716202</td>
<td>3</td>
<td>169.585052</td>
<td>58</td>
<td>145.230499</td>
<td>15</td>
<td>166.337051</td>
<td>15</td>
<td>265.844086</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>18</td>
<td>137.920044</td>
<td>8</td>
<td>141.980621</td>
<td>45</td>
<td>136.906982</td>
<td>45</td>
<td>137.201172</td>
<td>14</td>
<td>121.146545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>8</td>
<td>154.434723</td>
<td>14</td>
<td>161.993011</td>
<td>61</td>
<td>150.458466</td>
<td>8</td>
<td>148.634705</td>
<td>10</td>
<td>220.298950</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>28</td>
<td>85.081177</td>
<td>15</td>
<td>92.158417</td>
<td>28</td>
<td>87.053833</td>
<td>28</td>
<td>83.963623</td>
<td>2</td>
<td>144.254028</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>25</td>
<td>167.685181</td>
<td>0</td>
<td>166.856781</td>
<td>21</td>
<td>162.981720</td>
<td>39</td>
<td>169.478943</td>
<td>15</td>
<td>151.277313</td>
</tr>
</tbody>
</table>

<p>5 rows × 35 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-76" class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show_all_clusters(</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters_df=drawings_df,</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters=drawings_cropped_cluster16_I,</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title="drawings_cropped_cluster16_emb",</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-77" class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cropped_cluster16_id,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-65-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cropped_cluster32" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cropped_cluster32">drawings_cropped_cluster32</h4>
<div id="cell-79" class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster32_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster32_kmeans.train(drawings_cropped_emb)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster32_D,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster32_I,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_index.search(drawings_cropped_cluster32_kmeans.centroids, <span class="dv">16</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster32_kD,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster32_kI,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_cluster32_kmeans.index.search(drawings_cropped_emb, <span class="dv">1</span>)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster32_id"</span>] <span class="op">=</span> drawings_cropped_cluster32_kI</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster32_dist"</span>] <span class="op">=</span> drawings_cropped_cluster32_kD</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>3</td>
<td>169.585052</td>
<td>58</td>
<td>145.230499</td>
<td>15</td>
<td>166.337051</td>
<td>15</td>
<td>265.844086</td>
<td>15</td>
<td>257.350555</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>8</td>
<td>141.980621</td>
<td>45</td>
<td>136.906982</td>
<td>45</td>
<td>137.201172</td>
<td>14</td>
<td>121.146545</td>
<td>31</td>
<td>122.172424</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>14</td>
<td>161.993011</td>
<td>61</td>
<td>150.458466</td>
<td>8</td>
<td>148.634705</td>
<td>10</td>
<td>220.298950</td>
<td>1</td>
<td>217.335358</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>15</td>
<td>92.158417</td>
<td>28</td>
<td>87.053833</td>
<td>28</td>
<td>83.963623</td>
<td>2</td>
<td>144.254028</td>
<td>21</td>
<td>129.951965</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>166.856781</td>
<td>21</td>
<td>162.981720</td>
<td>39</td>
<td>169.478943</td>
<td>15</td>
<td>151.277313</td>
<td>15</td>
<td>141.268982</td>
</tr>
</tbody>
</table>

<p>5 rows × 37 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-80" class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show_all_clusters(</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters_df=drawings_df,</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters=drawings_cropped_cluster32_I,</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title="drawings_cropped_cluster32_emb",</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-81" class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cropped_cluster32_id,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-68-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cropped_cluster48" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cropped_cluster48">drawings_cropped_cluster48</h4>
<div id="cell-83" class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">48</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster48_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster48_kmeans.train(drawings_cropped_emb)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster48_D,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster48_I,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_index.search(drawings_cropped_cluster48_kmeans.centroids, <span class="dv">16</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster48_kD,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster48_kI,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_cluster48_kmeans.index.search(drawings_cropped_emb, <span class="dv">1</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster48_id"</span>] <span class="op">=</span> drawings_cropped_cluster48_kI</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster48_dist"</span>] <span class="op">=</span> drawings_cropped_cluster48_kD</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster64_dist</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>58</td>
<td>145.230499</td>
<td>15</td>
<td>166.337051</td>
<td>15</td>
<td>265.844086</td>
<td>15</td>
<td>257.350555</td>
<td>15</td>
<td>268.672974</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>45</td>
<td>136.906982</td>
<td>45</td>
<td>137.201172</td>
<td>14</td>
<td>121.146545</td>
<td>31</td>
<td>122.172424</td>
<td>31</td>
<td>116.409210</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>61</td>
<td>150.458466</td>
<td>8</td>
<td>148.634705</td>
<td>10</td>
<td>220.298950</td>
<td>1</td>
<td>217.335358</td>
<td>1</td>
<td>213.251678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>28</td>
<td>87.053833</td>
<td>28</td>
<td>83.963623</td>
<td>2</td>
<td>144.254028</td>
<td>21</td>
<td>129.951965</td>
<td>21</td>
<td>140.072540</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>21</td>
<td>162.981720</td>
<td>39</td>
<td>169.478943</td>
<td>15</td>
<td>151.277313</td>
<td>15</td>
<td>141.268982</td>
<td>15</td>
<td>145.393372</td>
</tr>
</tbody>
</table>

<p>5 rows × 39 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-84" class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show_all_clusters(</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters_df=drawings_df,</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters=drawings_cropped_cluster48_I,</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title="drawings_cropped_cluster48_emb",</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-85" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cropped_cluster48_id,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-71-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="drawings_cropped_cluster64" class="level4">
<h4 class="anchored" data-anchor-id="drawings_cropped_cluster64">drawings_cropped_cluster64</h4>
<div id="cell-87" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>ncentroids <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>niter <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">False</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster64_kmeans <span class="op">=</span> faiss.Kmeans(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_emb.shape[<span class="dv">1</span>], ncentroids, niter<span class="op">=</span>niter, verbose<span class="op">=</span>verbose, gpu<span class="op">=</span><span class="va">True</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>drawings_cropped_cluster64_kmeans.train(drawings_cropped_emb)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster64_D,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster64_I,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_index.search(drawings_cropped_cluster64_kmeans.centroids, <span class="dv">16</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster64_kD,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    drawings_cropped_cluster64_kI,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>) <span class="op">=</span> drawings_cropped_cluster64_kmeans.index.search(drawings_cropped_emb, <span class="dv">1</span>)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster64_id"</span>] <span class="op">=</span> drawings_cropped_cluster64_kI</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>drawings_df.loc[:, <span class="st">"drawings_cropped_cluster64_dist"</span>] <span class="op">=</span> drawings_cropped_cluster64_kD</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING clustering 1923 points to 64 centroids: please provide at least 2496 training points</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>15</td>
<td>166.337051</td>
<td>15</td>
<td>265.844086</td>
<td>15</td>
<td>257.350555</td>
<td>15</td>
<td>268.672974</td>
<td>58</td>
<td>276.820343</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>45</td>
<td>137.201172</td>
<td>14</td>
<td>121.146545</td>
<td>31</td>
<td>122.172424</td>
<td>31</td>
<td>116.409210</td>
<td>34</td>
<td>122.042419</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>8</td>
<td>148.634705</td>
<td>10</td>
<td>220.298950</td>
<td>1</td>
<td>217.335358</td>
<td>1</td>
<td>213.251678</td>
<td>1</td>
<td>191.671631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>28</td>
<td>83.963623</td>
<td>2</td>
<td>144.254028</td>
<td>21</td>
<td>129.951965</td>
<td>21</td>
<td>140.072540</td>
<td>21</td>
<td>144.775696</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>39</td>
<td>169.478943</td>
<td>15</td>
<td>151.277313</td>
<td>15</td>
<td>141.268982</td>
<td>15</td>
<td>145.393372</td>
<td>58</td>
<td>151.138092</td>
</tr>
</tbody>
</table>

<p>5 rows × 41 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-88" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show_all_clusters(</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters_df=drawings_df,</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     clusters=drawings_cropped_cluster64_I,</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     title="drawings_cropped_cluster64_emb",</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-89" class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.scatter(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">0</span>],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>drawings_cropped_X_tsne[:, <span class="dv">1</span>],</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>drawings_df.drawings_cropped_cluster64_id,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    s<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="21_e2e_subclusters_files/figure-html/cell-74-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="saving-cluster-outputs" class="level2">
<h2 class="anchored" data-anchor-id="saving-cluster-outputs">saving cluster outputs</h2>
<section id="save-the-tsvs-with-cluster-ids" class="level3">
<h3 class="anchored" data-anchor-id="save-the-tsvs-with-cluster-ids">save the TSV’s with cluster ID’s</h3>
<div id="cell-92" class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>preprocessing_dir</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP'</code></pre>
</div>
</div>
<div id="cell-93" class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>subclusters_dir <span class="op">=</span> (</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    singleline_data_home() <span class="op">/</span> <span class="st">"raster/epoch-20231214/04_SUBCLUSTERS"</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.isdir(subclusters_dir):</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    os.makedirs(subclusters_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-94" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>15</td>
<td>166.337051</td>
<td>15</td>
<td>265.844086</td>
<td>15</td>
<td>257.350555</td>
<td>15</td>
<td>268.672974</td>
<td>58</td>
<td>276.820343</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>45</td>
<td>137.201172</td>
<td>14</td>
<td>121.146545</td>
<td>31</td>
<td>122.172424</td>
<td>31</td>
<td>116.409210</td>
<td>34</td>
<td>122.042419</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>8</td>
<td>148.634705</td>
<td>10</td>
<td>220.298950</td>
<td>1</td>
<td>217.335358</td>
<td>1</td>
<td>213.251678</td>
<td>1</td>
<td>191.671631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>28</td>
<td>83.963623</td>
<td>2</td>
<td>144.254028</td>
<td>21</td>
<td>129.951965</td>
<td>21</td>
<td>140.072540</td>
<td>21</td>
<td>144.775696</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>39</td>
<td>169.478943</td>
<td>15</td>
<td>151.277313</td>
<td>15</td>
<td>141.268982</td>
<td>15</td>
<td>145.393372</td>
<td>58</td>
<td>151.138092</td>
</tr>
</tbody>
</table>

<p>5 rows × 41 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-95" class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>clustered_drawings_tsv_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>subclusters_dir<span class="sc">}</span><span class="ss">/clustered_drawings.tsv"</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>drawings_df.to_csv(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    clustered_drawings_tsv_fname, index<span class="op">=</span><span class="va">True</span>, index_label<span class="op">=</span><span class="st">"idx"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, header<span class="op">=</span><span class="va">True</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>clustered_drawings_df <span class="op">=</span> pd.read_csv(</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    clustered_drawings_tsv_fname, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, index_col<span class="op">=</span><span class="st">"idx"</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>clustered_drawings_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster16_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster32_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster48_dist</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_id</th>
<th data-quarto-table-cell-role="th">drawings_cropped_cluster64_dist</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p043.jpg</td>
<td>art/sb77p043.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.168532,0.008473,0.008068,0.016940,0.797986</td>
<td>-0.6198182,-0.5714155,-0.6871516,-0.6553513,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.42715576,1.4904574,-0.72562873,-0.662768,-0.6266761,0.6913696,0.054546177,-0.5467274,-0.6520286,0.117179275,0.94330966,0.5815062,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.4584825,-0.3818994,-0.5750927,-0.73986673,-0.45211998,-0.6141643,-0.67007643,-0.52171326,-0.4592305,1.4788612,-0.6186755,0.799198,-0.57338566,-0.17778617,0.10336053,0.093812525,0.17924881,-0.6189488,-0.6682474,2.1040225,-0.59257406,1.6553459,-0.6001429,0.5109105,0.19352531,-0.2517513,-0.66552746,-0.6482407,-0.4732...</td>
<td>11</td>
<td>199.22961</td>
<td>1</td>
<td>...</td>
<td>15</td>
<td>166.33705</td>
<td>15</td>
<td>265.844100</td>
<td>15</td>
<td>257.350560</td>
<td>15</td>
<td>268.67297</td>
<td>58</td>
<td>276.82034</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb67p021.jpg</td>
<td>art/sb67p021.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.170976,0.008673,0.008480,0.017028,0.794843</td>
<td>1.1073987,0.3512016,-0.73929733,-0.6553513,1.7477593,-0.65341413,0.32179314,-0.4896673,-0.1797334,-0.42715576,1.3163843,-0.72562873,-0.61387855,-0.6266761,-0.35361218,0.37611246,-0.08771938,-0.5262803,0.9261699,-0.6497359,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.32559583,-0.6690378,-0.4518578,0.51828945,-0.4238917,-0.45211998,-0.16527033,-0.67007643,1.0136865,-0.4592305,-0.600525,-0.060860336,-0.19446748,-0.24127388,2.2282472,1.8003348,-0.61049384,0.39795423,0.2626753,-0.6682474,-0.75794554,-0.59257406,0.80257696,-0.6001429,-0.651804,-0.028328001,0.53641737,-0.6501347,-0.6482407,0....</td>
<td>3</td>
<td>132.26111</td>
<td>0</td>
<td>...</td>
<td>45</td>
<td>137.20117</td>
<td>14</td>
<td>121.146545</td>
<td>31</td>
<td>122.172424</td>
<td>31</td>
<td>116.40921</td>
<td>34</td>
<td>122.04242</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb25p227.jpg</td>
<td>art/sb25p227.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.158396,0.008277,0.007424,0.016584,0.809319</td>
<td>1.3776337,-0.5714155,-0.2587232,-0.6553513,1.3532461,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.25077122,0.050992966,-0.72562873,0.1406585,-0.6266761,1.0653365,0.96198404,-0.5467274,0.30261123,0.6327609,-0.6497359,-0.64108604,-0.28434965,-0.35651857,-0.6779002,-0.28245115,-0.6690378,-0.4518578,0.030088186,-0.73986673,-0.18931103,-0.041653574,-0.67007643,-0.52171326,-0.29881266,-0.600525,-0.23231092,-0.73933,-0.57338566,-0.65925777,1.8833572,-0.61049384,0.44560486,0.14075392,-0.6682474,-0.75794554,-0.59257406,-0.07511848,-0.6001429,-0.651804,-0.5315948,0.023931146,0.723624,-0.6482407,-...</td>
<td>8</td>
<td>188.58075</td>
<td>0</td>
<td>...</td>
<td>8</td>
<td>148.63470</td>
<td>10</td>
<td>220.298950</td>
<td>1</td>
<td>217.335360</td>
<td>1</td>
<td>213.25168</td>
<td>1</td>
<td>191.67163</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb48p057.jpg</td>
<td>art/sb48p057.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.165322,0.008453,0.008010,0.016587,0.801628</td>
<td>2.4936543,0.17563903,-0.6522293,-0.55642915,1.1084181,-0.5028205,-0.046447277,-0.4896673,-0.7537334,-0.42715576,0.84124434,-0.72562873,-0.52445275,-0.5557985,-0.21369287,2.2372599,-0.26381853,-0.6520286,-0.6898426,-0.6497359,-0.64108604,0.43080842,-0.23286673,-0.6779002,0.7969176,-0.6690378,-0.4518578,0.747658,0.04896885,-0.45211998,-0.68509877,-0.2462106,0.7319356,-0.4592305,-0.600525,-0.6186755,-0.5338096,-0.57338566,1.1886733,0.04046011,-0.61049384,0.45326668,0.72983754,-0.6682474,-0.10000485,0.034278154,-0.33160114,-0.6001429,-0.651804,-0.5315948,-0.20898154,-0.66552746,1.2346795,-0.47...</td>
<td>14</td>
<td>90.26291</td>
<td>0</td>
<td>...</td>
<td>28</td>
<td>83.96362</td>
<td>2</td>
<td>144.254030</td>
<td>21</td>
<td>129.951970</td>
<td>21</td>
<td>140.07254</td>
<td>21</td>
<td>144.77570</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb77p044.jpg</td>
<td>art/sb77p044.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.171638,0.008182,0.008061,0.016469,0.795650</td>
<td>2.170152,-0.01916939,-0.47766963,-0.6553513,-0.44795185,-0.65341413,1.5596724,-0.4896673,-0.7537334,-0.42715576,1.0671424,-0.72562873,1.8207353,-0.6266761,-0.6194963,1.1724913,-0.5467274,0.12343103,1.5514618,-0.6497359,0.23890108,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.33040416,-0.4518578,0.39869583,0.120936334,-0.45211998,-0.68509877,0.2514736,0.17836922,-0.4592305,-0.600525,-0.6186755,-0.73933,-0.57338566,1.3668395,0.6006557,1.2428443,1.0844817,0.36636358,0.48543411,-0.5954572,-0.59257406,-0.30289415,1.2783914,0.5800507,-0.23473695,-0.59497476,-0.66552746,2.2758756,-0.4732165,-0....</td>
<td>4</td>
<td>176.29102</td>
<td>0</td>
<td>...</td>
<td>39</td>
<td>169.47894</td>
<td>15</td>
<td>151.277310</td>
<td>15</td>
<td>141.268980</td>
<td>15</td>
<td>145.39337</td>
<td>58</td>
<td>151.13809</td>
</tr>
</tbody>
</table>

<p>5 rows × 41 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-96" class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>clustered_watercolors_tsv_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>subclusters_dir<span class="sc">}</span><span class="ss">/clustered_watercolors.tsv"</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>watercolors_df.to_csv(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    clustered_watercolors_tsv_fname,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    index_label<span class="op">=</span><span class="st">"idx"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    header<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>clustered_watercolors_df <span class="op">=</span> pd.read_csv(</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    clustered_watercolors_tsv_fname, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, index_col<span class="op">=</span><span class="st">"idx"</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>clustered_watercolors_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">abs_fname</th>
<th data-quarto-table-cell-role="th">rel_fname</th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pred_label</th>
<th data-quarto-table-cell-role="th">pred_idx</th>
<th data-quarto-table-cell-role="th">pred_probs</th>
<th data-quarto-table-cell-role="th">emb_csv</th>
<th data-quarto-table-cell-role="th">cluster</th>
<th data-quarto-table-cell-role="th">cluster_dist</th>
<th data-quarto-table-cell-role="th">metacluster</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_name</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_id</th>
<th data-quarto-table-cell-role="th">handlabeled_metacluster_was_correct</th>
<th data-quarto-table-cell-role="th">preprocessed_abs_path</th>
<th data-quarto-table-cell-role="th">handlabeled_abs_path</th>
<th data-quarto-table-cell-role="th">emb_csv_cropped</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_id</th>
<th data-quarto-table-cell-role="th">watercolors_cluster_dist</th>
<th data-quarto-table-cell-role="th">watercolors_cropped_cluster_id</th>
<th data-quarto-table-cell-role="th">watercolors_cropped_cluster_dist</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb07p104.jpg</td>
<td>art/sb07p104.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.177406,0.008799,0.008245,0.017177,0.788373</td>
<td>-0.39105213,0.96309596,-0.73929733,0.4489988,0.8297614,-0.3937308,-0.7267234,-0.32461396,-0.7537334,-0.42715576,-0.62038505,-0.72562873,0.3037846,-0.6266761,-0.5213815,-0.31669965,-0.5467274,-0.6520286,-0.22544897,-0.6497359,-0.64108604,0.6374447,-0.5446661,-0.6779002,-0.14143991,-0.6690378,-0.44753593,0.66945183,-0.73986673,-0.45211998,-0.05996394,-0.21525535,0.82928157,-0.04412651,-0.600525,-0.04148197,-0.73825717,-0.57338566,-0.25227422,2.3566113,-0.61049384,1.0027854,-0.40134108,1.3733256,-0.75794554,-0.59257406,-0.4395525,-0.6001429,1.0358506,1.1911299,0.8162154,0.032713354,-0.6482407...</td>
<td>5</td>
<td>238.33170</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb07p104.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb07p104.jpg</td>
<td>-0.6198182,0.8895926,-0.73929733,0.6418346,0.46164584,1.0085131,-0.7267234,-0.4896673,-0.7537334,-0.42715576,-0.62038505,-0.72562873,1.4399182,-0.6266761,0.474914,-0.57515705,-0.5467274,-0.6520286,1.2274435,-0.6497359,-0.27622125,-0.45870692,-0.5446661,-0.6779002,1.3343718,-0.6690378,-0.4518578,0.42277813,-0.73986673,-0.45211998,1.6291834,-0.67007643,-0.09817025,-0.00090405345,-0.600525,-0.6186755,-0.73933,-0.57338566,0.006386578,1.034553,-0.61049384,-0.58021957,-0.09483403,0.78779536,-0.73080033,0.10947651,0.3367887,-0.5382227,-0.26548737,0.5630663,2.15088,0.2266624,-0.6482407,0.049348265...</td>
<td>7</td>
<td>215.02927</td>
<td>7</td>
<td>206.64117</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb31p017.jpg</td>
<td>art/sb31p017.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172119,0.008924,0.008226,0.016950,0.793781</td>
<td>-0.05104202,-0.3935787,-0.73929733,0.86878717,-0.6254566,-0.65341413,-0.7267234,-0.4896673,-0.7537334,-0.14799604,-0.62038505,-0.72562873,-0.2654881,-0.6266761,-0.68991846,-0.57515705,-0.41532665,-0.6520286,-0.6898426,-0.34099144,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.2674706,-0.53598946,-0.13334358,-0.5982413,-0.73986673,-0.45211998,-0.68509877,0.033780396,-0.52171326,0.054827005,-0.20721096,0.3301326,-0.73933,-0.57338566,0.34032136,-0.6179389,-0.20170414,0.16225064,-0.44437563,0.44581896,-0.069196045,0.20976627,-0.07846111,-0.6001429,0.38122594,-0.09738222,-0.59497476,-0.665527...</td>
<td>11</td>
<td>191.66959</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>True</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb31p017.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb31p017.jpg</td>
<td>1.491735,-0.5714155,-0.73929733,0.05867392,0.5154146,0.0936929,-0.7267234,-0.4896673,0.4246894,-0.42715576,-0.33477074,-0.72562873,1.2274611,-0.6266761,-0.68991846,-0.57515705,-0.5467274,1.1312869,-0.06054777,-0.028933167,-0.64108604,-0.55193967,-0.5446661,-0.6779002,-0.57759243,0.46393585,0.4817328,0.22738433,-0.73986673,-0.45211998,0.0057709217,-0.67007643,-0.52171326,0.68283725,0.060967267,0.7253895,-0.73933,-0.57338566,-0.65925777,-0.6179389,-0.32987997,0.86336035,-0.6189488,1.3613329,1.2250904,-0.59257406,-0.5857397,-0.6001429,-0.5687719,-0.14814761,0.5325973,-0.66552746,-0.6482407,0....</td>
<td>4</td>
<td>199.03098</td>
<td>4</td>
<td>195.97546</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb05p079.jpg</td>
<td>art/sb05p079.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.172158,0.008873,0.008536,0.017017,0.793416</td>
<td>1.8089037,-0.5714155,-0.73929733,-0.10773122,-0.22753507,0.34884918,0.124596715,-0.4896673,-0.27447522,-0.42715576,0.61659455,-0.03226477,-0.662768,-0.6266761,-0.68991846,-0.57515705,-0.39897114,-0.6520286,-0.6898426,-0.6497359,0.16184372,-0.55193967,-0.5446661,-0.6779002,0.04647112,-0.6690378,-0.4518578,0.9576235,0.29423904,-0.45211998,-0.68509877,0.09260088,-0.3948297,-0.4592305,-0.600525,-0.6186755,-0.64046603,-0.57338566,0.08902073,0.09568572,-0.61049384,0.7515181,-0.15892029,-0.4098586,1.8483992,-0.59257406,-0.6157326,-0.56642026,-0.651804,-0.44185895,-0.19970179,0.19587982,1.3608505,...</td>
<td>11</td>
<td>140.32997</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb05p079.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb05p079.jpg</td>
<td>-0.6013173,-0.5714155,-0.7368871,-0.6553513,-0.6254566,-0.65341413,0.071327925,-0.4896673,-0.7537334,-0.29406685,1.2854458,-0.72562873,1.4279991,-0.2084853,0.4439276,-0.57515705,-0.5467274,-0.2426523,0.6567551,-0.6497359,0.284827,-0.55193967,-0.5446661,-0.6779002,-0.57759243,-0.6690378,0.39760548,-0.5982413,-0.16403872,0.82081807,-0.68509877,-0.67007643,-0.16007048,-0.23898152,0.4340614,-0.6186755,-0.73933,-0.57338566,-0.65925777,-0.60700464,-0.22504222,1.2887287,0.17025876,-0.5827259,3.245521,-0.59257406,1.607188,-0.6001429,-0.1800242,-0.5315948,0.2059763,0.33526373,0.109642506,-0.0013180...</td>
<td>4</td>
<td>142.76602</td>
<td>4</td>
<td>248.37231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb26p082.jpg</td>
<td>art/sb26p082.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>1.8392665,0.3796271,-0.73929733,0.82189727,1.6830277,0.9302285,-0.5532687,-0.4896673,-0.30764756,-0.42715576,-0.44450876,-0.72562873,-0.662768,0.54702616,-0.68991846,-0.57515705,-0.31611928,-0.59368926,1.2819774,-0.6497359,-0.64108604,-0.55193967,0.84984857,-0.6779002,-0.06536412,-0.6690378,0.34403068,-0.16627067,0.3990196,-0.45211998,0.65170527,-0.67007643,0.6049255,-0.4367706,-0.600525,-0.0046679974,-0.73933,-0.109048486,-0.65925777,0.65358853,-0.61049384,0.70374626,-0.6189488,-0.6682474,-0.0177418,-0.59257406,1.1068444,-0.29651338,-0.651804,-0.5315948,1.8200746,-0.66552746,0.11623299,-0...</td>
<td>7</td>
<td>176.11029</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb26p082.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb26p082.jpg</td>
<td>0.8175719,0.48385304,-0.73929733,1.0291914,1.4682066,1.225123,-0.43518582,-0.4896673,-0.7537334,-0.42715576,0.72162604,-0.72562873,-0.662768,-0.6266761,-0.55470747,-0.57515705,-0.5467274,-0.6520286,2.099903,-0.6497359,-0.64108604,-0.55193967,1.3572993,-0.6779002,1.3149762,0.8512635,0.81857395,-0.5982413,0.056738913,-0.45211998,2.0946088,-0.67007643,-0.52171326,-0.4592305,-0.600525,1.1100725,-0.73933,-0.57338566,-0.24140868,0.9004108,-0.61049384,0.4742828,-0.6189488,-0.6682474,0.335356,0.40166396,0.7790335,-0.6001429,-0.651804,-0.4778452,0.7360641,-0.66552746,-0.6482407,-0.13845,-0.7311095,...</td>
<td>1</td>
<td>157.93832</td>
<td>1</td>
<td>196.84943</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/01_FLAT/art/sb69p101-color.jpg</td>
<td>art/sb69p101-color.jpg</td>
<td>art</td>
<td>xtra</td>
<td>4</td>
<td>0.179525,0.008828,0.008282,0.017196,0.786169</td>
<td>-0.23259398,-0.5714155,-0.73929733,-0.6553513,0.34417403,1.046661,-0.42288247,-0.4896673,0.39017296,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.93892807,-0.57515705,-0.5222921,-0.6520286,-0.6898426,-0.6497359,-0.6366938,-0.55193967,-0.5446661,-0.6779002,-0.46687827,-0.6690378,-0.4518578,-0.5982413,0.7252437,-0.45211998,1.8137504,-0.67007643,-0.52171326,-0.36457688,-0.600525,0.8178272,-0.73933,0.23574609,-0.65925777,-0.6179389,-0.61049384,-0.15158218,-0.41958112,-0.6682474,-0.75794554,0.4943592,0.8210626,-0.6001429,-0.651804,-0.080083996,0.48374963,-0.42743486,-0.6482407,-0.4...</td>
<td>7</td>
<td>187.45346</td>
<td>1</td>
<td>...</td>
<td>1_watercolors</td>
<td>1</td>
<td>NaN</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/10_SIMPLE_CROP/1_watercolors/sb69p101-color.jpg</td>
<td>/Users/al/Dropbox/2-Areas/2-Sketchbooks/datasets/full-v2/03_VISUAL_HAND_LABELED/1_watercolors/sb69p101-color.jpg</td>
<td>0.14908737,-0.5714155,-0.73929733,0.44245207,-0.6254566,1.4611686,-0.7267234,-0.4896673,0.87923527,-0.42715576,-0.62038505,-0.72562873,-0.662768,-0.6266761,0.4918049,-0.57515705,-0.5467274,-0.6520286,-0.6898426,-0.2860955,-0.64108604,-0.55193967,-0.5446661,-0.6779002,0.69009775,-0.6690378,-0.4518578,0.18292433,-0.004632473,-0.45211998,1.7543458,-0.67007643,-0.52171326,-0.41669255,-0.600525,1.4654884,0.5742926,-0.57338566,-0.65925777,-0.6179389,-0.52983093,0.26484245,-0.25630984,-0.6682474,0.19898295,0.95297796,0.38033813,-0.6001429,-0.651804,-0.5315948,1.3264011,0.31547034,-0.6482407,-0.47...</td>
<td>1</td>
<td>167.27823</td>
<td>1</td>
<td>136.63800</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-99" class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>drawing_centroids <span class="op">=</span> {</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"drawings_emdb"</span>: {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster8"</span>: (drawings_D.tolist(), drawings_I.tolist()),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster16"</span>: (</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>            drawings_cluster16_D.tolist(),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>            drawings_cluster16_I.tolist(),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster32"</span>: (</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            drawings_cluster32_D.tolist(),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>            drawings_cluster32_I.tolist(),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster48"</span>: (</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>            drawings_cluster48_D.tolist(),</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>            drawings_cluster48_I.tolist(),</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster64"</span>: (</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>            drawings_cluster64_D.tolist(),</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>            drawings_cluster64_I.tolist(),</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"drawings_cropped_emdb"</span>: {</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster8"</span>: (</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_D.tolist(),</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_I.tolist(),</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster16"</span>: (</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster16_D.tolist(),</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster16_I.tolist(),</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster32"</span>: (</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster32_D.tolist(),</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster32_I.tolist(),</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster48"</span>: (</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster48_D.tolist(),</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster48_I.tolist(),</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster64"</span>: (</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster64_D.tolist(),</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>            drawings_cropped_cluster64_I.tolist(),</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-100" class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see also: https://github.com/facebookresearch/faiss/issues/2087</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>drawing_centroids_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>subclusters_dir<span class="sc">}</span><span class="ss">/centroids_drawings.json"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(drawing_centroids_fname, <span class="st">"w"</span>) <span class="im">as</span> outfile:</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    json.dump(drawing_centroids, outfile, indent<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-104" class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>watercolor_centroids <span class="op">=</span> {</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"watercolors_emdb"</span>: {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cluster8"</span>: (watercolors_D.tolist(), watercolors_I.tolist()),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"watercolors_cropped_emdb"</span>: {</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"drawings_cropped_cluster8"</span>: (</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            watercolors_cropped_D.tolist(),</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>            watercolors_cropped_I.tolist(),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-105" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>watercolor_centroids_fname <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>subclusters_dir<span class="sc">}</span><span class="ss">/centroids_watercolors.json"</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(watercolor_centroids_fname, <span class="st">"w"</span>) <span class="im">as</span> outfile:</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    json.dump(watercolor_centroids, outfile, indent<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-106" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pprint <span class="im">import</span> pprint</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>pprint(watercolor_centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-107" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finish saving</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/singleline-dataset\.andrewlook\.com\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/andrewlook/singleline_dataset/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>